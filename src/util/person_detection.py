import cv2
from numpy import ndarray
from src.model.InputType import InputType
from src.model.work import Work
from src.util.file_reader import base64_to_img, fetch_image_from_url


def count_people(original_img: ndarray, grayscale_img: ndarray, debug_mode: bool = False) -> int:
    hog = cv2.HOGDescriptor()
    hog.setSVMDetector(cv2.HOGDescriptor_getDefaultPeopleDetector())

    rects, weights = hog.detectMultiScale(grayscale_img, winStride=(2, 2), padding=(10, 10), scale=1.02)

    certain_counter = 0

    for i, (x, y, w, h) in enumerate(rects):
        if weights[i] > 0.7:
            certain_counter += 1
            if debug_mode: cv2.rectangle(original_img, (x, y), (x + w, y + h), (0, 255, 0), 2)
        else:
            continue

    if debug_mode:
        print("Found " + str(certain_counter) + " people.")
        cv2.imshow('HOG detection', original_img)
        cv2.waitKey(0)

    return certain_counter


def resize_image(image: ndarray) -> ndarray:
    if image.shape[1] < 400:  # if image width < 400
        (height, width) = image.shape[:2]
        ratio = width / float(height)  # find the width to height ratio
        return cv2.resize(image, (400, int(height * ratio)))  # resize the image according to the width to height ratio
    else:
        return image


def person_detection(image: ndarray, debug_mode: bool = False):
    image = resize_image(image)
    img_gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    return count_people(original_img=image, grayscale_img=img_gray, debug_mode=debug_mode)


def get_image_ndarray_for_job(work: Work) -> ndarray:
    if work.input_type == InputType.PATH:
        print("Reading image from path")
        return cv2.imread(work.source)
    if work.input_type == InputType.URL:
        print("Reading image from url")
        return fetch_image_from_url(work.source)
    if work.input_type == InputType.BASE64:
        print("Reading image from base 64")
        print(work.source)
        return base64_to_img(work.source)


if __name__ == "__main__":
    imb64 = "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"
    image = base64_to_img(imb64)
    # url = "https://img.freepik.com/free-photo/people-posing-together-registration-day_23-2149096794.jpg"
    # image_from_url = fetch_image_from_url(url)
    person_detection(image, debug_mode=True)